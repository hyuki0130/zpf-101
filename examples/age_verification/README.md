# Age Verification - ë‚˜ì´ ê²€ì¦ ZKP ì˜ˆì œ

ì´ ì˜ˆì œëŠ” Zero-Knowledge Proofë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œ ë‚˜ì´ë¥¼ ê³µê°œí•˜ì§€ ì•Šê³  ìµœì†Œ ë‚˜ì´ ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤.

## ğŸ¯ ì‹œë‚˜ë¦¬ì˜¤

**ì‚¬ìš©ì**: "ì €ëŠ” 18ì„¸ ì´ìƒì…ë‹ˆë‹¤" (ì‹¤ì œ ë‚˜ì´ëŠ” ë¹„ë°€)
**ì„œë¹„ìŠ¤**: "ì¦ëª…ì´ ìœ íš¨í•©ë‹ˆë‹¤. ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì„¸ìš”!" (ì‹¤ì œ ë‚˜ì´ë¥¼ ëª¨ë¦„)

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
age_verification/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.nr          # Noir íšŒë¡œ ì½”ë“œ
â”œâ”€â”€ Prover.toml          # ì‚¬ìš©ìì˜ ë¹„ë°€ ì…ë ¥ê°’
â”œâ”€â”€ Nargo.toml           # í”„ë¡œì íŠ¸ ì„¤ì •
â””â”€â”€ target/              # ì»´íŒŒì¼ ê²°ê³¼ë¬¼
    â”œâ”€â”€ age_verification.json  # ACIR ë°”ì´íŠ¸ì½”ë“œ
    â”œâ”€â”€ age_verification.gz    # Witness íŒŒì¼
    â”œâ”€â”€ vk                     # ê²€ì¦ í‚¤
    â””â”€â”€ proof                  # ìƒì„±ëœ ì¦ëª…
```

## ğŸ” íšŒë¡œ ì„¤ëª…

`src/main.nr`:
```rust
fn main(age: u8, min_age: pub u8) {
    assert(age >= min_age);
}
```

- **Private ì…ë ¥**: `age` - ì‚¬ìš©ìì˜ ì‹¤ì œ ë‚˜ì´ (ë¹„ë°€)
- **Public ì…ë ¥**: `min_age` - ì„œë¹„ìŠ¤ì˜ ìµœì†Œ ë‚˜ì´ ìš”êµ¬ì‚¬í•­ (ê³µê°œ)
- **ì¦ëª…**: "age >= min_ageë¥¼ ë§Œì¡±í•˜ëŠ” age ê°’ì„ ì•Œê³  ìˆìŠµë‹ˆë‹¤"

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1ë‹¨ê³„: ì…ë ¥ê°’ ì„¤ì •

`Prover.toml`ì— ì‹¤ì œ ë°ì´í„°ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤:
```toml
age = "25"        # ë¹„ë°€: ì‹¤ì œ ë‚˜ì´
min_age = "18"    # ê³µê°œ: ìµœì†Œ ë‚˜ì´ ìš”êµ¬ì‚¬í•­
```

### 2ë‹¨ê³„: ì»´íŒŒì¼

```bash
nargo compile
```

**ìƒì„±ë˜ëŠ” íŒŒì¼**: `target/age_verification.json` (ACIR ë°”ì´íŠ¸ì½”ë“œ)

### 3ë‹¨ê³„: Witness ìƒì„±

```bash
nargo execute
```

**ìƒì„±ë˜ëŠ” íŒŒì¼**: `target/age_verification.gz` (ëª¨ë“  ì¤‘ê°„ ê³„ì‚°ê°’)

ì´ ë‹¨ê³„ì—ì„œ íšŒë¡œê°€ ì‹¤ì œë¡œ ì‹¤í–‰ë˜ì–´ `25 >= 18` ì¡°ê±´ì´ ë§Œì¡±ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

### 4ë‹¨ê³„: ê²€ì¦ í‚¤ ìƒì„± (âš ï¸ ì¤‘ìš”!)

```bash
bb write_vk -b ./target/age_verification.json -o ./target
```

**ìƒì„±ë˜ëŠ” íŒŒì¼**: `target/vk` (ê²€ì¦ í‚¤)

**ì™œ í•„ìš”í•œê°€?**
- ì¦ëª… ìƒì„± ì „ì— ê²€ì¦ í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤
- í•œ ë²ˆë§Œ ìƒì„±í•˜ë©´ ê³„ì† ì¬ì‚¬ìš© ê°€ëŠ¥
- íšŒë¡œê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í•œ ë‹¤ì‹œ ìƒì„±í•  í•„ìš” ì—†ìŒ

### 5ë‹¨ê³„: ì¦ëª… ìƒì„±

```bash
bb prove -b ./target/age_verification.json -w ./target/age_verification.gz -o ./target
```

**ìƒì„±ë˜ëŠ” íŒŒì¼**: `target/proof` (ì•½ 2KB í¬ê¸°ì˜ ì¦ëª…)

**ëŒ€ì•ˆ (ê²€ì¦ í‚¤ ë™ì‹œ ìƒì„±)**:
```bash
bb prove -b ./target/age_verification.json -w ./target/age_verification.gz --write_vk -o ./target
```

**ì°¸ê³ **: í”Œë˜ê·¸ëŠ” ì–¸ë”ìŠ¤ì½”ì–´(`_`)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤: `--write_vk` (í•˜ì´í”ˆì´ ì•„ë‹˜!)

### 6ë‹¨ê³„: ì¦ëª… ê²€ì¦

```bash
bb verify -p ./target/proof -k ./target/vk
```

**ì„±ê³µ ì‹œ ì¶œë ¥**:
```
Proof verification successful!
```

## ğŸ” ì˜¤ë¥˜ í•´ê²°

### âŒ "Unable to open file: ./target/vk"

**ì›ì¸**: ê²€ì¦ í‚¤ê°€ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

**í•´ê²° ë°©ë²•**:
```bash
# ë°©ë²• 1: ê²€ì¦ í‚¤ ë¨¼ì € ìƒì„±
bb write_vk -b ./target/age_verification.json -o ./target

# ë°©ë²• 2: ì¦ëª… ìƒì„± ì‹œ --write-vk í”Œë˜ê·¸ ì‚¬ìš©
bb prove -b ./target/age_verification.json -w ./target/age_verification.gz --write-vk -o ./target
```

## ğŸ­ ì—­í•  êµ¬ë¶„

### ì¦ëª…ì (Prover) - ì‚¬ìš©ì/í´ë¼ì´ì–¸íŠ¸
1. `Prover.toml`ì— ì‹¤ì œ ë°ì´í„° ì…ë ¥
2. `nargo execute`ë¡œ Witness ìƒì„±
3. `bb prove`ë¡œ ì¦ëª… ìƒì„±
4. **ì„œë²„ì— ì „ì†¡**: `proof` íŒŒì¼ë§Œ

### ê²€ì¦ì (Verifier) - ì„œë²„/ë°±ì—”ë“œ
1. `vk` (ê²€ì¦ í‚¤) ë³´ê´€
2. ì‚¬ìš©ìë¡œë¶€í„° `proof` ìˆ˜ì‹ 
3. `bb verify`ë¡œ ê²€ì¦
4. âœ… ìœ íš¨ì„± í™•ì¸ (ì‹¤ì œ ë‚˜ì´ëŠ” ëª¨ë¦„!)

## ğŸŒ ì „ì²´ ì›Œí¬í”Œë¡œìš°

```
[í´ë¼ì´ì–¸íŠ¸]                              [ì„œë²„]
     |                                      |
1. age=25 ì…ë ¥ (Prover.toml)                |
     |                                      |
2. nargo execute â†’ witness.gz              |
     |                                      |
3. bb prove â†’ proof                        |
     |                                      |
4. POST /verify { proof, min_age: 18 }     |
     |                                5. bb verify
     |                                   â†’ Valid âœ“
     |                                      |
6. â† { verified: true }                    |
     |                                      |
  ì„œë¹„ìŠ¤ ì ‘ê·¼ í—ˆìš©!                          |
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

### ì„±ê³µ ì¼€ì´ìŠ¤ (age >= min_age)
```toml
age = "25"
min_age = "18"
```
â†’ ì¦ëª… ìƒì„± ì„±ê³µ, ê²€ì¦ ì„±ê³µ

### ì‹¤íŒ¨ ì¼€ì´ìŠ¤ (age < min_age)
```toml
age = "15"
min_age = "18"
```
â†’ `nargo execute` ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨ (assert ì‹¤íŒ¨)

## ğŸ“Š íŒŒì¼ í¬ê¸°

- `age_verification.json`: ~1.2 KB (ACIR ë°”ì´íŠ¸ì½”ë“œ)
- `age_verification.gz`: ~60 B (Witness)
- `vk`: ~500 B (ê²€ì¦ í‚¤)
- `proof`: ~2 KB (ìƒì„±ëœ ì¦ëª…)

## ğŸ”’ ë³´ì•ˆ íŠ¹ì„±

### ê³µê°œ ê°€ëŠ¥í•œ ê²ƒ
- âœ… `proof` - ì¦ëª… íŒŒì¼
- âœ… `vk` - ê²€ì¦ í‚¤
- âœ… `age_verification.json` - íšŒë¡œ ë°”ì´íŠ¸ì½”ë“œ
- âœ… `min_age` - ê³µê°œ ì…ë ¥ê°’

### ì ˆëŒ€ ê³µê°œí•˜ë©´ ì•ˆ ë˜ëŠ” ê²ƒ
- âŒ `Prover.toml` - ë¹„ë°€ ì…ë ¥ê°’
- âŒ `age_verification.gz` - Witness íŒŒì¼
- âŒ ì‹¤ì œ `age` ê°’

## ğŸ“ í•™ìŠµ í¬ì¸íŠ¸

1. **Witness ìƒì„±**: íšŒë¡œë¥¼ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ì—¬ ëª¨ë“  ì¤‘ê°„ê°’ ê³„ì‚°
2. **ì¦ëª… ìƒì„±**: ì•”í˜¸í•™ì  ë³€í™˜ì„ í†µí•´ ë¹„ë°€ì„ ìˆ¨ê¹€
3. **ê²€ì¦**: ë¹„ë°€ì„ ì•Œì§€ ëª»í•´ë„ ì¦ëª…ì˜ ìœ íš¨ì„± í™•ì¸ ê°€ëŠ¥
4. **ê²€ì¦ í‚¤**: ì¦ëª… ìƒì„± ì „ì— ë°˜ë“œì‹œ í•„ìš” (ìµœì‹  bb ë²„ì „)

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

ì´ ì˜ˆì œë¥¼ ì´í•´í–ˆë‹¤ë©´:
1. `age` ê°’ì„ ë°”ê¿”ê°€ë©° í…ŒìŠ¤íŠ¸
2. `min_age < age` ì¼€ì´ìŠ¤ë¡œ ì‹¤íŒ¨ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
3. ìƒì„±ëœ `proof` íŒŒì¼ í¬ê¸° í™•ì¸
4. [Chapter 5: ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜](../../tutorials/05-web-application.md)ì—ì„œ ì‹¤ì œ ì•± êµ¬í˜„

## ğŸ“š ì°¸ê³  ìë£Œ

- [Noir ê³µì‹ ë¬¸ì„œ](https://noir-lang.org)
- [Barretenberg ë¬¸ì„œ](https://barretenberg.aztec.network)
- [Chapter 4: ì¦ëª… ìƒì„±ê³¼ ê²€ì¦](../../tutorials/04-proof-generation.md)
